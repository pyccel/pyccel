name: 'Pyccel pytest commands'

runs:
  using: "composite"
  steps:
    - name: Test with pytest
      run: |
        python -m pytest -rx -m "not parallel and c" epyccel/test_epyccel_openmp.py 
        python -m pytest -rx -m "not parallel and not c and not python" epyccel/test_epyccel_openmp.py
        python -m pytest ndarrays/ -rx
        mpiexec -n 4 ${MPI_OPTS} python -m pytest epyccel/test_parallel_epyccel.py -v -m parallel -rx
        #mpiexec -n 4 ${MPI_OPTS} python -m pytest epyccel -v -m parallel -rx
      shell: bash
      working-directory: ./tests
